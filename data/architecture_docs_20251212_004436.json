{
  "system_overview": {
    "name": "IoTSentinel",
    "type": "Network Security Monitor for IoT Devices",
    "deployment": "Raspberry Pi 5 (4GB RAM)",
    "architecture_pattern": "Layered architecture with event-driven components"
  },
  "layers": [
    {
      "layer": "Presentation Layer",
      "components": [
        "Web Dashboard (Dash + Plotly)"
      ],
      "technologies": [
        "Python Dash",
        "Plotly",
        "Bootstrap",
        "JavaScript"
      ],
      "responsibilities": [
        "User interface and visualization",
        "Real-time chart updates via WebSocket",
        "3D network topology visualization",
        "Alert management interface"
      ]
    },
    {
      "layer": "Application Layer",
      "components": [
        "Alert Manager",
        "Device Group Manager",
        "Authentication Manager",
        "Report Generator"
      ],
      "technologies": [
        "Python",
        "Flask-Login",
        "SMTP"
      ],
      "responsibilities": [
        "Business logic and workflows",
        "Alert prioritization and routing",
        "User authentication and RBAC",
        "PDF/CSV report generation"
      ]
    },
    {
      "layer": "ML Processing Layer",
      "components": [
        "Inference Engine",
        "Autoencoder Model",
        "Isolation Forest Model",
        "Feature Extractor"
      ],
      "technologies": [
        "TensorFlow/Keras",
        "scikit-learn",
        "NumPy"
      ],
      "responsibilities": [
        "Real-time anomaly detection",
        "Feature extraction from network traffic",
        "Model training and retraining",
        "Consensus voting for accuracy"
      ]
    },
    {
      "layer": "Data Collection Layer",
      "components": [
        "Packet Capture Service (Pcap+dpkt)",
        "Zeek NSM Parser",
        "ARP Scanner",
        "Baseline Collector"
      ],
      "technologies": [
        "Pcap",
        "dpkt",
        "Zeek",
        "Scapy"
      ],
      "responsibilities": [
        "Network packet capture and parsing",
        "Protocol analysis (HTTP, DNS, SSL, etc.)",
        "Device discovery via ARP",
        "Baseline traffic collection"
      ]
    },
    {
      "layer": "Data Persistence Layer",
      "components": [
        "SQLite Database",
        "File Storage"
      ],
      "technologies": [
        "SQLite3",
        "Python sqlite3 module"
      ],
      "responsibilities": [
        "Device information storage",
        "Alert and connection history",
        "User accounts and settings",
        "ML model persistence"
      ]
    }
  ],
  "data_flow": [
    "1. Router forwards network traffic to Raspberry Pi (via port mirroring)",
    "2. Packet Capture Service captures packets using Pcap+dpkt",
    "3. Zeek NSM parses packets and extracts protocol-level features",
    "4. Feature Extractor transforms data into 17 ML features",
    "5. Inference Engine scores traffic using dual ML models",
    "6. Consensus Voter combines scores from both models",
    "7. Alert Manager generates alerts if anomaly detected",
    "8. Dashboard displays real-time data and alerts to user",
    "9. Notification system sends email/push notifications"
  ],
  "design_patterns": [
    {
      "pattern": "Repository Pattern",
      "usage": "DatabaseManager class abstracts database operations",
      "file": "database/db_manager.py"
    },
    {
      "pattern": "Strategy Pattern",
      "usage": "Dual ML models with pluggable algorithms",
      "file": "ml/inference_engine.py"
    },
    {
      "pattern": "Observer Pattern",
      "usage": "Alert subscribers notified of anomaly events",
      "file": "alerts/notification_dispatcher.py"
    },
    {
      "pattern": "Singleton Pattern",
      "usage": "Configuration manager, database connection pool",
      "file": "config/config_manager.py"
    }
  ],
  "technology_decisions": [
    {
      "decision": "Pcap+dpkt over PyShark",
      "rationale": "50% lower CPU usage critical for Raspberry Pi",
      "evidence": "Benchmark: 45% vs 78% CPU"
    },
    {
      "decision": "SQLite over MySQL/PostgreSQL",
      "rationale": "Embedded database, no separate server, perfect for edge",
      "evidence": "Zero-configuration, <10ms query time"
    },
    {
      "decision": "Dual ML models (Autoencoder + Isolation Forest)",
      "rationale": "Consensus voting reduces false positives by 40%",
      "evidence": "Measured in test scenarios"
    },
    {
      "decision": "Dash over React/Vue",
      "rationale": "Python-native, rapid development, built-in Plotly integration",
      "evidence": "Dashboard built in days, not weeks"
    }
  ]
}
