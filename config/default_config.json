{
  "system": {
    "name": "IoTSentinel",
    "version": "1.0.0",
    "environment": "production",
    "architecture": "zeek-based",
    "status_file_path": "config/monitoring_status.json",
    "health_check_interval_seconds": 600
  },
  "network": {
    "interface": "wlan0",
    "local_networks": [
      "192.168.1.0/24"
    ],
    "zeek_enabled": true,
    "zeek_bin_path": "/opt/zeek/bin",
    "zeek_log_path": "/opt/zeek/logs",
    "arp_scan_interval": 300
  },
  "zeek": {
    "parse_interval_seconds": 60,
    "log_types": [
      "conn",
      "http",
      "dns"
    ],
    "json_format": true
  },
  "ml": {
    "engine": "river",
    "river_engine_path": "data/models/river_engine.pkl",
    "feature_extractor_path": "data/models/feature_extractor.pkl",
    "inference_batch_size": 100,
    "inference_interval_seconds": 300,
    "anomaly_threshold": 0.7,
    "device_anomaly_threshold": 0.7,
    "auto_save_interval": 100,
    "note": "River-based incremental learning - no training needed!"
  },
  "ai_assistant": {
    "enabled": true,
    "groq_api_key": "",
    "groq_enabled": true,
    "ollama_enabled": true,
    "ollama_url": "http://localhost:11434/api/generate",
    "ollama_model": "phi3.5:mini",
    "ollama_timeout": 15,
    "fallback_to_rules": true,
    "note": "Groq API key loaded from GROQ_API_KEY environment variable"
  },
  "database": {
    "path": "data/database/iotsentinel.db",
    "retention_days": 30
  },
  "dashboard": {
    "host": "0.0.0.0",
    "port": 8050,
    "debug": false
  },
  "logging": {
    "level": "INFO",
    "log_dir": "data/logs"
  },
  "alerting": {
    "enabled": true,
    "max_per_device_per_hour": 5,
    "max_global_per_hour": 20,
    "cooldown_minutes": 15,
    "severity_thresholds": {
      "critical": 0.98,
      "high": 0.95,
      "medium": 0.85,
      "low": 0.7
    },
    "reports": {
      "weekly_enabled": true,
      "weekly_day": "sunday",
      "weekly_hour": 9,
      "monthly_enabled": true,
      "monthly_day": 1,
      "monthly_hour": 9
    }
  },
  "email": {
    "enabled": "true",
    "smtp_host": "",
    "smtp_port": "587",
    "smtp_user": "",
    "smtp_password": "",
    "sender_email": "",
    "recipient_email": "",
    "note": "Email settings are loaded from environment variables (.env file)"
  },
  "firewall": {
    "enabled": "false",
    "router_ip": "192.168.1.1",
    "router_user": "root",
    "router_private_key_path": "~/.ssh/id_rsa"
  },
  "threat_intelligence": {
    "enabled": "true",
    "abuseipdb_api_key": "",
    "cache_hours": "24",
    "note": "API key loaded from THREAT_INTELLIGENCE_ABUSEIPDB_API_KEY environment variable"
  },
  "nvd": {
    "enabled": "true",
    "api_key": "",
    "sync_interval_hours": 24,
    "cache_ttl_hours": 24,
    "match_threshold": 0.85,
    "iot_keywords": [
      "IoT",
      "router",
      "camera",
      "smart",
      "embedded"
    ],
    "note": "API key loaded from NVD_API_KEY environment variable"
  },
  "discovery": {
    "mode": "passive",
    "active_scan_enabled": false,
    "nmap_enabled": false,
    "upnp_active_enabled": false,
    "mdns_active_enabled": false,
    "active_scan_interval": 3600
  }
}
